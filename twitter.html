<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>

/*
    $(document).ready(function(){

      //find people that like spectre vs people that dont like
      //why do we not need document ready
      var movie = prompt("Which one do you want to see???");

      //this is not good when you have parameters
      // function changeRadius2(rad)
      //better to do the way beneath because you can override ananchorLeftCorner method
      var changeRadius2 = function (rad) {
        console.log('hi');
      }
      $("p").click(changeRadius2);


      $("p").click(function(){
        changeRadius();
      });

      function changeRadius() {
        var radius = prompt('What radius would you like?');
        //want both spectre and martian
        var site = "http://cooper-union-search-proxy.herokuapp.com/twitter/search/martian%20OR%20spectre?q=%20%3A&geocode=40.748817,-73.985428,"+radius+"km&result_type=recent";
        console.log(site);

        $.getJSON(site,function(response){

          var martianLikes = 0;
          var spectreLikes = 0;
          for (var i=0; i<response.statuses.length; i++){

            var strLC = response.statuses[i].text.toLowerCase();
            if(strLC.search("martian")>=0){
                martianLikes++;
            }
            else if (strLC.search("spectre")>=0){
                spectreLikes++;
            }
          }

          if (martianLikes>spectreLikes){
            $('#top').toggle('.martian');
            $('#top').toggle('.spectre');
            $('#bottom').toggle('.spectre');
            $('#bottom').toggle('.martian');
          }
          else {
            $('#bottom').toggle('.martian');
            $('#top').toggle('.spectre');
          }
          console.log(martianLikes + " are talking about 'Martian' and " + spectreLikes + " people are talking about 'Spectre'.");
        });
      };


    });
*/

    $(document).ready(function(){
      var site = "http://cooper-union-search-proxy.herokuapp.com/twitter/search/spectre?q=%20%3A&geocode=40.748817,-73.985428,1km&result_type=recent";


      $.getJSON(site,function(response){
        var numResponses = response.statuses.length;
        var randomResponse = Math.floor(Math.random() * numResponses);
        var text = response.statuses[randomResponse].text;
        var textArray = text.split(" ");
        console.log(text);
        console.log(textArray);

        //$('.center').append("<span>asdasdasd</span>");
        //$('span').css('border','1px solid black');
        //$('.anchorLeftCorner').css('position','relative');

        var windowWidth = $(window).width();
        var windowHeight = $(window).height();
        console.log("window height and width are " + windowHeight + windowWidth);
        var gifHeight = $("#gif").height();
        var gifWidth = $("#gif").width();
        console.log("height and width are " + gifHeight + gifWidth);

        for (var i = 0; i < textArray.length; i++){
          // var ranY = -150;
          var ranY = Math.random() * windowHeight;
          var y = ranY+"px";

          //x just needs to be less than the width of the window
          var ranX = Math.random() * windowWidth;
          if (ranY >= (windowHeight/2 - gifHeight/2) && ranY < (windowHeight/2 + gifHeight/2)){
              console.log(y);
              console.log(x);
              //x has to be less than 0 or greater than the width
              if (ranX <= windowWidth/2 && ranX >= windowWidth/2 - gifWidth/2)
                ranX -= gifWidth/2;
              else if (ranX > windowWidth/2 && ranX <= windowWidth/2 + gifWidth/2)
                ranX += gifWidth/2;
          }
          //ranX= 180;
          var x = ranX+"px";

          var style = {
            'position':'relative',
            'top':y,
            'left':x
          }
          var word = $('<span>');
          word.addClass().attr('id',i).text(textArray[i]).css(style).appendTo('.anchorLeftCorner');
          word.css('position','absolute');
          // word.toggleClass('shot');
        }

        $('#gif').css("background-image","url('giphy.gif')");

        var interval = setInterval(rotateWord,1150);

        var i = 0;
        function rotateWord(){
          console.log(i);
          $('span[id="'+i+'"]').toggleClass('shot');
          i++;
          if (i > textArray.length){
            clearInterval(interval);
            //remove all the text
            $('.anchorLeftCorner').empty();
            $('#gif').remove();
            //$('h1').css("display","block!important");
            $('h1').removeClass('hide');
            $('body')
              .css("background-image","url('http://www.hdwallpaper.nu/wp-content/uploads/2015/10/007SpectreFanArtByDCDesigns.png')")
              .css("background-size","cover")
              .css("background-repeat","no-repeat");
          }
        }

      });
    });

    </script>

    <style>
      div {
        height: 300px;
        width: 400px;
        background-size: contain;
        background-repeat: no-repeat;
      }
      #gif{
        /*width: 400px;*/
        height: 200px;
        position: absolute;
        top: 50%; left: 50%;
        margin-left: -200px;
        margin-top: -100px;
        /*border: 1px solid blue;*/
        /*background-image: url("giphy.gif");*/
        background-position: center;

      }
      span{
        color: red;
        transition: transform 0.3s linear;
        -webkit-transform-origin: 0 0;
        -moz-transform-origin: 0 0;
        -ms-transform-origin: 0 0;
        -o-transform-origin: 0 0;
        transform-origin: 0px 0px;
        /*transform-origin: left top;*/
      }
      .shot{
        color: blue;
        transform: rotate(90deg);
      }

      h1 {
        text-align: center;
        font-family: fantasy;
        color: white;
      }
      h1:first-child{
        font-size: 30px;
      }
      .hide{
        /*display:none;*/
        color:transparent;
      }
    </style>
  </head>
  <body>
    <div class="anchorLeftCorner"></div>
    <h1 class="hide">10/10!</h1>
    <div class="center" id="gif"></div>
    <h1 class="hide">Still haven't watched this yet? What are you waiting for?</h1>

    <!-- <div id="top" class="martian">

    </div>
    <p>Click to change radius</p>
    <div id="bottom" class="spectre" >
    </div> -->

  </body>
</html>
